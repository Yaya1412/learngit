# Linux笔记

### Linux基础知识

```shell
linux   操作系统 万物皆文件,多用户、多任务的操作系统
linux 是个大小写严格区别的输入环境
```

	[用户名@主机名 当前路径]	[root@locathost ~]#
	用户的身份
	    # root身份
	    $ 普通用户身份
```
ssh 安全远程连接协议 默认端口：22
加密传输，非对称
命令方式连接：
    语法：ssh 用户名@主机名   主机名=ip
    示例：ssh root@192.168.1.223
```

```
[root@localhost ~]#   linux的命令提示符
[C:\~]$ 	windows 的命令提示符
```

```
主目录，也称之为 家目录，home目录
f1 ~ f6: 文本命令化界面	f7:图形化界面
```

```
drwxr-xr-x   2 root root  4096 Mar 29 06:06 bin
r 可读	w 可写	x 可执行  - 该位置没有对应的权限
    第一列：
        第一个位置:文件类型
            d 目录 - 普通文件 l 链接文件
        第二个位置:3个字符为一组
            第一组：该文件/目录的持有者权限，该文件/目录的创建者
            第二组：该文件/目录的所属组权限
            第三组：其他用户的权限
    第二列：文件的链接数量
    第三列：文件/目录的持有者
    第四列：文件/目录的所属组对象
    第五列：文件/目录的大小     默认字节单位
    第六列：创建时间\上一次修改时间
    第七列：文件/目录的名称
```

```
用户和用户组的关系：
    用户：权限的集合
    用户组：具有相同属性权限的用户集合
```

```
具有针对x文件/目录可读权限的用户，分配同一个用户组
    一：	一对一
    二：	一对多
    三：	多对一
    四：	多对多
```

```
用户创建之后，没有密码，还不能使用
用户信息文件  /etc/passwd
```

```
用户信息文件解释：一个用户表示一行记录
t30:x:5000:5000:演示账号:/home/t30:/bin/bash
    以：为分隔符进行分割解释
    第一个：用户名
    第二个：占位符 密码
    第三个：用户编号
    第四个：用户组编号
    第五个：备注、注解
    第六个：home地址
    第七个：bash环境
```

```
linux用户类型：主要作用于系统的稳定性，特殊指令
    1、root  管理员  uid=0
    2、程序用户\系统用户 
        linux5版本 uid(1~499)
        linux7版本 uid(1~999)
    3、普通用户  工作人员用的  
    	linux5版本 uid(500~6w)
        linux7版本 uid(1000~6w)
```

```
*	相当于mysql中学习的	%
?	相当于mysql中学习的	_
```

```
快照 vmware 把系统做一个备份
    系统已启动	特点：备份相对完整，占用磁盘开销
    系统未启动

```

```
数据重定向
如果右边的对象不存在，则自动新建
    >:覆盖内容
    >>:追加内容
    示例：cat t30 > ttt
```

```
环境变量：用户环境&系统环境
shell 脚本
    .bash_profile 
    .bashrc     
系统环境配置文件   系统变量
    /etc/profile
```

```
用户组信息文件 /etc/group
    t30:x:5000:
    	以冒号做分隔符：
            第一列：组名
            第二列：占位符
            第三列：组编号
            第四列：组员
```

```
白名单
    hosts.allow
        sshd:192.168.1.19
        sshd:192.168.1.0/255.255.255.0
黑名单
    hosts.deny
    	sshd:ALL
优先级 hosts.allow > hosts.deny
```

```
如果遗忘了root账户的密码
    启用单用户模式，重置root密码
    1 开机显示3s内按任意键，进入选择模式
    2、根据提示，点字母e进入编辑模式
    3、光标选中第二项，再点字母e
    4、进入编辑模式，在最后面加空格，输入single都可以，然后点击回车。再根据后续的提示点击字母b启动。
    5、启动后不需要输入密码，直接进入了主机下面。输入命令passwd，即可修改root的密码。
```

```
配置ip，静态ip，手工ip
	/etc/sysconfig/network-scripts/  网络文件路径 [ifcfg- 开头的是网卡配置文件]
    dhcp 	 动态主机分配协议：自动获取一个ip地址
    static	 静态协议
    HWADDR	 物理地址  MAC地址 独一无二
    ONBOOT 	 是否启动该配置

修改了网络配置文件，需要重新启动网络服务，让其生效
网卡配置文件里面的参数
    DEVICE=eth0 　　　　 　　		#网卡对应的设备别名
    BOOTPROTO=static 　　　　　　#网卡获得ip地址的方式（默认为dhcp，表示自动获取）
    HWADDR=00:07:E9:05:E8:B4  	#网卡MAC地址（物理地址）
    IPADDR=192.168.100.100       #IP地址
    NETMASK=255.255.255.0        #子网掩码
    GATEWAY=192.168.100.1　　　　　#网关
    DNS1=192.168.100.254         #设置DNS1
    DNS2=192.168.100.253         #设置DNS2
    ONBOOT=yes                   #系统启动时是否激活此设备
```



### Linux常用命令

#### 2022年3月29日笔记

##### 1.cd 相对路径

```
.  当前目录	
.. 上一层目录
cd ../../ 去到上一层的上一层
cd ~      去到当前用户的主目录  /home 普通用户的主目录
cd ~oldbear 去到oldbear用户的主目录
cd ~root 去到root用户的主目录   /root root用户的主目录
cd - 去到上一次路径
```

##### 2.pwd，dir：显示工作目录  工作站

##### 3.date 打印系统时间日期

date -s "时间日期格式"		例如：date -s "2022-03-29 14:03:00"

##### 4.查看ip地址:ifconfig 设备名(适配器)		

例如：ifconfig eth0 [redhat5版本，默认适配器 = eth0]

##### 5.重启网络服务[5版本]:service network restart

##### 6.退出命令：logout = exit

##### 7.ls 列出指定路径下的文件/目录(默认当前路径)

```
语法：ls [参数] [路径]
常用参数： 
    -l  长格式,详情信息,更多属性
    -i  列出对应的索引节点
    -a  包含隐藏文件/目录
    示例：ls -ali /root
注意：该命令的参数位置不需要指定
解释：以长格式，并且显示索引节点，还包含隐藏的文件/目录
```

##### 8.who 查看谁在服务器上

```
root     pts/0        2022-03-29 14:56 (192.168.1.194)
用户名	 pts远程 tty本地
```

##### 9.useradd  新增用户

```
语法：useradd [参数] 用户名
常用：
    -u 用户编号
    -d 指定主目录路径
    -c 备注
    -g 用户组编号
    示例： useradd -u5000 t30
    解释：创建用户t30,用户编号为5000
注意1：新增用户的时候，会自动创建一个跟用户名相似的用户组
注意2：如果不指定用户编号和用户组编号，那么用户编号默认从已存在用户编号基础上+1，用户组编号和用户编号默认一致，用户不可以重复、用户组不可以重复
```

##### 10.usermod 用户信息修改

```
语法:usermod [参数] 用户名
常用参数：
    -c 备注
    -g 组编号
    -d 主目录地址
```

##### 11.userdel 删除用户

```
语法：userdel -r 用户名
    -r 连通主目录一起删除
```

##### 12.groupadd 新增用户组

```
语法：groupadd -g 组名
	-g  组编号
```

##### 13.groupmod 用户组信息修改

```
语法：groupmod -g 组名
	-g 组编号
```

##### 14.groupdel 用户组删除		语法：groupdel 组名

##### 15.history  查看历史命令记录

```
语法: history 
    指令:	!!    执行上一次命令
         !n    执行第n次命令
```

##### 16.touch 创建文件	语法：touch [路径/]文件名

##### 17.mkdir 创建目录

```
语法：mkdir [参数] [路径/]目录名
常用参数：
	-p 级联创建
```

##### 18.rmdir  删除空目录	语法：rmdir 目录名

##### 19.rm 删除文件/目录  *****

```
语法：rm [参数] [路径/目录]文件
常用参数：
    -r  递归级联删除	
    -f  直接运行，无需询问
```

##### 20.pkill 结束进程--> 踢用户下线	语法: pkill -kill -t类型

##### 21.passwd 设置/修改用户的密码状态

```
语法：passwd [参数] [用户名]
常用参数：
    -S  常看密码状态
    -l  锁定密码
    -u  解锁密码
不带参数，则进行修改密码
不带用户名，则对当前用户进行操作
```

##### 22.查看文件/日志：cat

```
语法： cat [参数] 文件对象
常用参数：
    -n 或 --number：由 1 开始对所有输出的行数编号。
	-b 或 --number-nonblank：和 -n 相似，只不过对于空白行不编号。
	-s 或 --squeeze-blank：当遇到有连续两行以上的空白行，就代换为一行的空白行。
```

##### 23.清屏 :clear = ctrl + l 、reset

```
clear = ctrl + l 是字母  翻页		快
reset	清空屏幕信息缓存			  慢
```



#### 2022年3月30日笔记

##### 24.vi  文本编辑器

```
打开文件语法：
    vi [+n] [文件名]
主意：当打开不存在的文件，会先虚拟新建，直到保存，会真正的建立

三种模式：
    1、插入模式
        i  切换到插入模式，可以在光标前输入信息
        I  切换到插入模式，光标跳转到所在行行首，可以输入信息
        a  切换到插入模式，可以在光标后输入信息
        A  切换到插入模式，光标跳转到所在行行末，可以输入信息
        o  光标所在行下一行，新建一行，进行输入
        O  光标所在行上一行，新建一行，进行输入
        r  替换光标位置的一个字符
        R  替换光标位置的字符，一直替换，直到esc回到普通模式	
    2、末行模式
        :   	进入末行状态
        :w  	保存文件
        :w  	文件名  另存为指定文件
        :w  	[路径/目录]文件名
        :q  	退出vi
        :q! 	强制退出 
        :wq 	保存并退出
        :set nu  	 显示序号 nu = number
        :set nonu 	取消序号
        /word 从上往下查找word关键字，光标停留在第一个匹配的word上,n匹配下一个，N匹配上一个
        ?word 从下往上查找word关键字，光标停留在第一个匹配的word上,n匹配下一个，N匹配上一个
        :n1,n2 del   删除n1到n2行之间的记录
        :n1,n2 co n3 	复制n1到n2行之间的记录到n3行粘贴
        :n1,n2s/word1/word2/g  	n1到n2行之间，替换 关键字word1为关键字word2
        :1,$s/word1/word2/g    全文替换把word1改为word2
    3、命令模式
        0  		光标跳转所在行行首
        d0 		从光标处开始到行首的内容都删除
        $  		光标跳转所在行行末
        d$		从光标处开始到行末的内容都删除
        w  		光标跳转下一个单词
        nw 		光标跳转n个单词
        dd 		删除光标所在整行记录
        ndd 	删除光标所在行到后面n行之间的记录
        n方向键  根据nq值取决于方向键的指令
        cc 		剪切光标所在整行记录
        ncc 	剪切光标所在行，到后面n行记录
        yy  	复制光标所在整行记录
        nyy 	复制光标所在行，到后面n行记录
        p   	在光标后粘贴
        P   	在光标前粘贴
        G		光标跳转到文末最后一行行首
        nG		光标跳转到文中第n行行首
        gg  	光标跳转到第一行行首
        ZZ  	保存并退出
        u       撤销上一次操作
```

##### 25.cp 复制文件/目录

```
语法：cp [参数] 源文件 [路径/目录][新文件名]
-r 针对目录
```

##### 26.echo 打印内容到屏幕		示例： echo '内容'

##### 27.head 查看文件，默认查看前10行

```
语法：head [参数] 文件对象
常用参数：
-n   查看前n行
```

##### 28.tail 查看文件，默认查看末尾10行

```
语法：tail [参数] 文件对象
-n   查看末尾n行
-f   动态查看
```

##### 29.more 查看文件

```
语法：more [参数] 文件对象
常用参数：
    -n   每页固定多少行   空格下一页
    +n   从第几行开始显示
    q    直接退出more
```

##### 30.less 分页查看文件

```
语法：less [参数] 文件 
常用参数：
    -b <缓冲区大小> 设置缓冲区的大小
    -e 当文件显示结束后，自动离开
    -f 强迫打开特殊文件，例如外围设备代号、目录和二进制文件
    -g 只标志最后搜索的关键词
```

##### 31.|   管道符

```
指令1 | 指令2  把指令1的输入
    输入  | 输出
    cat t30 | more -2  读大文件推荐
```

##### 32.wc   统计命令

```
语法：wc [参数] 对象
常用参数：
    -l 统计行
    -w 统计单词
    -c 统计字节
需求：统计root主目录有多少个文件/目录
	ls ~root | wc -l
linux有多少个用户
	解答：wc -l /etc/passwd
```

##### 33.grep  过滤

```
语法：grep [参数] [对象]
常用参数：
    -n  带序号
    -i  忽略大小写
```

##### 34.alias 别名

```
为特殊的指令设置一个别名
    查看别名的内容 alias 别名
    设置别名：alias 别名='具体指令内容'
    取消别名：unalias 别名
```

##### 35.find  查找文件

```
语法：find 路径 参数 对象名
常用参数：
    -name  根据文件名
    -type  根据文件类型 
        f普通文件
        d目录文件
        l链接文件
        b块文件
        c字符文件
    -ctime  根据创建时间
    -mtime 	根据修改时间
    -size   +n  大于  -n 小于
		特点：如果查找范围太大，速度比较慢，什么都能查
```

##### 36.which、whereis 查找可执行文件

```
which path变量的路径去查找
whereis 文件数据库  帮助文档
```

##### 37.export 设置变量

```
export 变量名=值	双引号可以识别变量名
取消: unset 变量名
```

##### 38.chmod  文件权限修改

```
语法：chmod [参数] 文件对象
常用参数：
    对象属性
        a  	所有对象
        u  	拥有者
        g	所属组
        o	其他用户
    权限属性
        r	可读
        w	可写
        x	可执行
权限操作
    + 增加权限 - 移除权限 = 赋值权限
    例如：新增t30文件其他用户的写权限	chmod o+w t30
= 赋值权限:rwx=7	[r = 4、  w = 2、  x = 1、  - = 0]
    语法：
        chmod xxx 文件对象
        chmod 777 t30	所有用户赋予所有权限:rwxrwxrwx
            -R 目录的子级
            示例：chmod o+w -R t1
            t1是目录，新增可写权限，所有子级连同生效
```

##### 39.gpasswd 新增移除用户-->用户组

```
语法：gpasswd [参数] 用户 用户组
    -a 新增
    -d 移除
    示例：把t30用户新增到 root用户组
        gpasswd -a t30 root
        gpasswd -aoldbear root
```

##### 40.id 用户名	查看指定用户的相关编号信息

##### 41.mv  移动

```
语法：mv 源文件 到哪里去
    示例：
        mv t30 test  test不是目录，则是把t30重命名为test
        mv t30 test/ test是目录，则是把t30移动到test目录里
```

##### 42.chown 改变文件/目录对象的持有者

```
语法：chown [参数] 用户 文件对象
常用参数：
	-R 级联传递
```

##### 43.chgrp 改变文件/目录对象的所属组

```
语法：chgrp [参数] 用户组 文件对象
常用参数：
	-R 级联传递
```

##### 44.ln 链接

```
语法：ln [参数] 源文件 链接名
常用参数：
	-s 软链接  当没有s参数，则是创建硬链接
	软链接 相当于 windows 快捷方式
    特点：
        1、硬链接和源文件的索引节点值相同，软链接和源文件索引节点不同 
        2、硬链接只能针对文件，软链接可以针对文件/目录
        3、硬链接不能跨文件系统
```

##### 45.cut 切片

```
语法：cut [参数] 文件对象
常用：
    -d 指定分隔符
    -f 返回第n列
    
需求1：列出linux系统上所有用户名
	示例：cut -d':' -f1 /etc/passwd
需求2：列出linux系统上所有用户名和用户编号
	示例：cut -d':' -f1,3 /etc/passwd
```



#### 2022年3月31日笔记

##### 46.ps 查看进程 静态

```
语法：ps [参数]
常用参数：
    -a 所有进程
    -u 列出用户
    -x 格式化
用法：ps aux 或者 ps -ef

如何统计服务器有多少个进程已经启动
ps aux | wc -l
    USER : 进程的持有者
    PID	 : 进程编号
    %CPU : cpu的占有率
    %MEN : 内存的占有率
    vsz rss : 虚拟内存使用情况
    TTY  : 终端类型
    STAT : 进程状态
    START：启动时间
    TIME ：运行时间
    COMMAND : 实际命令
    PPID : 父进程编号
         # 0 - 停机（千万不能把initdefault 设置为0 ）
         # 1 - 单用户模式
         # 2 - 多用户，没有 NFS
         # 3 - 完全多用户模式(标准的运行级)
         # 4 - 没有用到
         # 5 - X11 (xwindow)
         # 6 - 重新启动 （千万不要把initdefault 设置为6 ）
```

##### 47.kill 结束进程

```
语法： kill [参数] pid
常用参数：
	-9  强制性
用法：kill -9 进程编号
僵尸进程：把他的父进程杀死
```



##### 48.service 进程管理

```
语法：service 进程名 动作
	动作：启动、重启、停止、状态
		start、restart、stop、status
	例如：service network restart	重启网络服务
         firewalld、iptables	防火墙
        
```

##### 49.systemctl 进程管理

```
语法：systemctl 动作 服务名
	动作：启动、重启、停止、状态、开机启动、开机禁用
        start、restart、stop、status、enable、disable
```

##### 50.top 查看进程 动态 

```
-dn  每隔n秒刷新一次数据
进去后：
    M  根据内存的使用排序
    P  根据cpu的使用排序
    q  退出top
```

##### 51.sort 排序 

```
配合ps 来进程排序查询
常用参数：
    -n  以数值排序
    -r	降序
    -k	指定列
需求：列出服务器内存使用最高的前5个进程信息
	ps aux | sort -nr -k4 | head - 5
其中STAT状态位常见的状态字符有
    D      解释：无法中断的休眠状态（通常 IO 的进程）； 
    R      解释：正在运行中在队列中可通过的； 
    S      解释：处于休眠状态； 
    T      解释：停止或被追踪； 
    W      解释：进入内存交换 （从内核2.6开始无效）； 
    X      解释：死掉的进程 （基本很少见）； 
    Z      解释：僵尸进程； 
    <      解释：优先级高的进程 
    N      解释：优先级较低的进程 
    L      解释：有些页被锁进内存； 
    s      解释：进程的领导者（在它之下有子进程）； 
    l      解释：多线程，克隆线程（使用 CLONE_THREAD, 类似 NPTL pthreads）； 
    +      解释：位于后台的进程组；
```

##### 52.winscp 远程文件管理工具，ls -l 当中第二列

```
当是个文件时，表示链接的数量
当是个目录时，表示子集目录的数量
```

##### 53.tar=> gz、bz 包   

```
语法：tar 参数 包 [参数] [路径]
常用参数：
    -f  后面跟指定文件，多个参数时，放在最后(必须)
    -x  解包
    -c  打包
    -j	bz  压缩率更小
    -z	gz	稳定性最好
    -t  查看包内的文件
    -C  指定路径
    -v  列出过程

示例1：指定tar.gz解包，解包到当前路径
	tar -xzf apache-tomcat-7.0.85.tar.gz
示例2：指定tar.gz解包，解包到指定的路径
	tar -xzf apache-tomcat-7.0.85.tar.gz -C 指定路径
示例3：把所有文件打包
    tar -cvf 打包的名 要打包的源文件 
    tar -cf apache.tar *
示例4：查看包内的文件
	tar -tf 包名
```

##### 54.rpm 红帽包管理器，主要是管理rpm格式的包

```
语法：rpm 参数 [包名]
    rpm -qa 查看系统已安装的所有包
    rpm -ivh 安装指定的包，并显示过程
    rpm -e 卸载指定包
    rpm -ql 查询指定包的安装文件(路径)
    -U 更新，如果没有更新源，则进行安装
    --force 强制性
    --nodeps 解决依赖

示例1：安装指定包
	rpm -ivh MySQL-client-5.5.1_m2-1.glibc23.i386.rpm 
示例2：查看刚才安装的包
	rpm -qa | grep -i mysql
示例3：查看刚才安装包的文件、路径
	rpm -ql MySQL-client 
示例4：卸载指定包
	rpm -e MySQL-client
示例5：强制性安装依赖包
	rpm -ivh --force --nodeps MySQL-server-5.5.1_m2-1.glibc23.i386.rpm
```

##### 55.scp 远程文件传输(上传/下载)

```
语法：
上传: scp 文件路径 服务器账号@服务器ip:存放位置	[注意：存放位置要写绝对路径]
	示例：scp apache-tomcat-7.0.85.tar.gz root@192.168.1.205:/usr/teacher/
下载：scp 服务器账号@服务器ip:存放位置 存放的位置
	示例：scp root@192.168.1.205:/usr/teacher/apache.tar.gz ./
```

##### 56.hostname 修改主机名

```
修改主机名：hostname 临时主机名
    主机名解析配置文件(本地dns解析文件)
        /etc/hosts
    主机名文件  永久修改
        /etc/sysconfig/network
```

##### 57.ifconfig 查看网卡信息

```
默认：ifconfig   查看所有已启动的网卡信息
    ifconfig 网卡名  查看指定网卡信息
    ifconfig 网卡名 ip地址  设置指定网卡的临时ip
    ifconfig 网卡名 up      启动指定网卡  等同于  ifup 		网卡名
    ifconfig 网卡名 down	禁用指定网卡  等同于  ifdown 	网卡名
```



##### 58.netstat  查看网络协议及端口信息

```
常用组合参数
    netstat –ntlp    显示 tcp 的监听端口
    netstat –r       显示路由表
    netstat –rn      显示路由表不做名称解析（较快）
    netstat –an      显示本地的连接
    netstat -at      显示tcp连接
    netstat -ap      显示连接和进程名
    netstat -l		 显示监听的状态
    netstat -s 		 每个协议的统计信息，包括接收/发送的包数量
    netstat -i		 显示网卡的统计信息
```

```
Proto ：网络传输协议，主要为tcp和udp
Local Address ：本地的ip:port
Foreign Address：远程主机的ip:port
State ：连线状态，主要有监听（ LISTEN）和建立（ESTABLISED）
PID ：服务的进程编号
Program name：服务名称

过滤出某个端口
与grep  组合使用来过滤出某个端口的连接，
   netstat -anp | grep :3306
解释：列出3306端口连接有哪些

统计连接个数
通过与wc 和 grep 命令连用，可以统计指定端口的连接数量
   netstat -anp | grep :3306 | wc -l	解释：输出 mysql 服务端口（即 3306）的连接数

问题：如果发现mysql端口被占用，你会如何解决
一般我会用netstat 先查看下3306(mysql)被那个进程占用了,然后查看这个进程的编号 [ps -aux | grep 端口] ，使用kill结束这个占用3306端口的进程， 或者 给mysql重新配置其他没有被占用的端口
```

